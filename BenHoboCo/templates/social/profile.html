{% extends 'social/base.html' %}
{% block block_body %}
<div class="row">
	<div class="page-header">
		<!-- <h1>{{ author.user.username }} <a href="" class="btn btn-success"><span class="glyphicon glyphicon-plus"></span> Add Friend</a></h1> -->

		<h1>
			<form method="POST" action="/authors/{{user.username}}/friends/addfriend/" >
				{% csrf_token %}
				{{ author.user.username }} 
				<input type="hidden" name="friend_name" value="{{author.user.username}}"/>
				<input type="submit" value="Add Friend" class="btn btn-success"/>
			</form>	
		</h1>

		{% if author.user.username == user.username %}
			<div class="text-right">
				<a href="/posts/create/" class="btn btn-primary">Create New Post</a>
			</div>
		{% endif %}

	</div>


	{% if success %}
		<div class="alert alert-success">
			Post created successfully!
		</div>
	{% endif %}

	{% if error %}
		<div class="alert alert-error">
			{{ error }}
		</div>
	{% endif %}


	<div class="col-md-4">
		<div class="panel panel-default">
			<div class="panel-heading">
				<h2 class="panel-title">Profile</h2>
			</div>
			<ul class="list-group">
					<li class="list-group-item">
						{% if author.image %}
							<img src="{{ author.image.url | urlencode }}"/> 
						{% elif user.username == author.user.username %}
							<p class="text-warning"> You have no picture!  Why not add one today? </p>
							<form action="/authors/{{ user.username }}/images/upload/" method="post" enctype="multipart/form-data">
								{% csrf_token %}
								<p>
									<input id="id_image" type="file" name="image">
								</p>
								<input type="submit" class="btn btn-default" value="Upload">
							</form>
						{% else %}
							<p class="text-warning"> This user has no picture! </p>
						{% endif %}
					</li>
				</ul>
		</div>
	</div>

	<div class="col-md-8">
		<div class="panel panel-primary">
			<div class="panel-heading">
				<h2 class="panel-title">Posts</h2>
			</div>

			<ul class="list-group">
				{% for post in user_posts %}
				<li class="list-group-item">
					<div class="text-right">
						{% if author.user.username == user.username %}
							<form action="/posts/{{ post.id }}/delete/" method="post">
								{% csrf_token %}
								<a href="javascript:;" onclick="parentNode.submit();"><span class="glyphicon glyphicon-remove"></span></a>
							</form>
						{% endif %}
					</div>
					<h4 class="list-group-item-heading"> {{ post.author.user.username }} : {{ post.time_stamp }} </h4>
					<p class="list-group-item-text">{{ post.content | safe }}</p>
				</li>
				{% endfor %}
			</ul>
		</div>
	</div>
</div>

{% endblock %}